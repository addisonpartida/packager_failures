{"status": "success", "data": {"resultType": "streams", "result": [{"stream": {"app": "packager-daemon", "attributes__timestamp": "2024-05-07T21:33:25.757Z", "attributes__version": "1", "attributes_class": "com.liveramp.daemon_lib.executors.KubeJobletExecutor", "attributes_exception_exception_class": "com.liveramp.daemon_lib.utils.DaemonException", "attributes_exception_exception_message": "java.lang.RuntimeException: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.", "attributes_exception_stacktrace": "com.liveramp.daemon_lib.utils.DaemonException: java.lang.RuntimeException: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\n\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:107)\n\tat com.liveramp.daemon_lib.executors.KubeJobletExecutor.execute(KubeJobletExecutor.java:74)\n\tat com.liveramp.daemon_lib.Daemon.processNext(Daemon.java:155)\n\tat com.liveramp.daemon_lib.Daemon.start(Daemon.java:108)\n\tat com.liveramp.s2s_packager.daemons.PackagerDaemon.main(PackagerDaemon.java:185)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.hadoop.util.RunJar.run(RunJar.java:323)\n\tat org.apache.hadoop.util.RunJar.main(RunJar.java:236)\nCaused by: java.lang.RuntimeException: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\n\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:151)\n\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:91)\n\t... 10 more\nCaused by: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\n\tat com.liveramp.s2s_packager.ruby.YamlMetadataBuilder.write(YamlMetadataBuilder.java:47)\n\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:139)\n\t... 11 more\nCaused by: java.lang.IllegalStateException: Cannot write empty metadata file.\n\tat com.liveramp.s2s_packager.ruby.YamlMetadataBuilder.write(YamlMetadataBuilder.java:44)\n\t... 12 more", "attributes_file": "KubeJobletExecutor.java", "attributes_line_number": "77", "attributes_log_iostream": "stdout", "attributes_logger_name": "com.liveramp.daemon_lib.executors.KubeJobletExecutor", "attributes_mdc_joblet_identifier": "4610756552300308151042", "attributes_mdc_request_id": "4740683361", "attributes_mdc_source_host": "packager-daemon-7cc6576dd6-k9nq8", "attributes_message": "Exception during joblet lifecycle for joblet 4610756552300308151042", "attributes_method": "execute", "attributes_source_host": "packager-daemon-7cc6576dd6-k9nq8", "attributes_thread_name": "main", "body": "<nil>", "cluster_name": "opi-prod-2", "environment": "prod", "exporter": "OTLP", "level": "ERROR", "namespace": "default", "project": "liveramp-eng-dist", "region": "us", "resources_container_image_name": "gcr.io/liveramp-eng/s2s_packager", "resources_container_image_tag": "57de195-54", "resources_k8s_pod_name": "packager-daemon-7cc6576dd6-k9nq8", "service_name": "packager-daemon", "team": "opi"}, "values": [["1715117605757749592", "{\"body\":\"\\u003cnil\\u003e\",\"attributes\":{\"@timestamp\":\"2024-05-07T21:33:25.757Z\",\"@version\":1,\"class\":\"com.liveramp.daemon_lib.executors.KubeJobletExecutor\",\"exception\":{\"exception_class\":\"com.liveramp.daemon_lib.utils.DaemonException\",\"exception_message\":\"java.lang.RuntimeException: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\",\"stacktrace\":\"com.liveramp.daemon_lib.utils.DaemonException: java.lang.RuntimeException: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\\n\\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:107)\\n\\tat com.liveramp.daemon_lib.executors.KubeJobletExecutor.execute(KubeJobletExecutor.java:74)\\n\\tat com.liveramp.daemon_lib.Daemon.processNext(Daemon.java:155)\\n\\tat com.liveramp.daemon_lib.Daemon.start(Daemon.java:108)\\n\\tat com.liveramp.s2s_packager.daemons.PackagerDaemon.main(PackagerDaemon.java:185)\\n\\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\n\\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\n\\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\n\\tat java.lang.reflect.Method.invoke(Method.java:498)\\n\\tat org.apache.hadoop.util.RunJar.run(RunJar.java:323)\\n\\tat org.apache.hadoop.util.RunJar.main(RunJar.java:236)\\nCaused by: java.lang.RuntimeException: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\\n\\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:151)\\n\\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:91)\\n\\t... 10 more\\nCaused by: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\\n\\tat com.liveramp.s2s_packager.ruby.YamlMetadataBuilder.write(YamlMetadataBuilder.java:47)\\n\\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:139)\\n\\t... 11 more\\nCaused by: java.lang.IllegalStateException: Cannot write empty metadata file.\\n\\tat com.liveramp.s2s_packager.ruby.YamlMetadataBuilder.write(YamlMetadataBuilder.java:44)\\n\\t... 12 more\"},\"file\":\"KubeJobletExecutor.java\",\"line_number\":\"77\",\"log.iostream\":\"stdout\",\"logger_name\":\"com.liveramp.daemon_lib.executors.KubeJobletExecutor\",\"mdc\":{\"joblet_identifier\":\"4610756552300308151042\",\"request_id\":4740683361,\"source_host\":\"packager-daemon-7cc6576dd6-k9nq8\"},\"message\":\"Exception during joblet lifecycle for joblet 4610756552300308151042\",\"method\":\"execute\",\"source_host\":\"packager-daemon-7cc6576dd6-k9nq8\",\"thread_name\":\"main\"},\"resources\":{\"container.image.name\":\"gcr.io/liveramp-eng/s2s_packager\",\"container.image.tag\":\"57de195-54\",\"k8s.pod.name\":\"packager-daemon-7cc6576dd6-k9nq8\"}}"]]}, {"stream": {"app": "packager-daemon", "attributes__timestamp": "2024-05-07T21:33:25.635Z", "attributes__version": "1", "attributes_class": "com.liveramp.s2s_packager.daemons.PackagerJoblet", "attributes_exception_exception_class": "java.lang.RuntimeException", "attributes_exception_exception_message": "java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.", "attributes_exception_stacktrace": "java.lang.RuntimeException: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\n\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:151)\n\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:91)\n\tat com.liveramp.daemon_lib.executors.KubeJobletExecutor.execute(KubeJobletExecutor.java:74)\n\tat com.liveramp.daemon_lib.Daemon.processNext(Daemon.java:155)\n\tat com.liveramp.daemon_lib.Daemon.start(Daemon.java:108)\n\tat com.liveramp.s2s_packager.daemons.PackagerDaemon.main(PackagerDaemon.java:185)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.hadoop.util.RunJar.run(RunJar.java:323)\n\tat org.apache.hadoop.util.RunJar.main(RunJar.java:236)\nCaused by: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\n\tat com.liveramp.s2s_packager.ruby.YamlMetadataBuilder.write(YamlMetadataBuilder.java:47)\n\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:139)\n\t... 11 more\nCaused by: java.lang.IllegalStateException: Cannot write empty metadata file.\n\tat com.liveramp.s2s_packager.ruby.YamlMetadataBuilder.write(YamlMetadataBuilder.java:44)\n\t... 12 more", "attributes_file": "PackagerJoblet.java", "attributes_line_number": "101", "attributes_log_iostream": "stdout", "attributes_logger_name": "com.liveramp.s2s_packager.daemons.PackagerJoblet", "attributes_mdc_joblet_identifier": "4610756552300308151042", "attributes_mdc_request_id": "4740683361", "attributes_mdc_source_host": "packager-daemon-7cc6576dd6-k9nq8", "attributes_message": "Error while packaging", "attributes_method": "run", "attributes_source_host": "packager-daemon-7cc6576dd6-k9nq8", "attributes_thread_name": "main", "body": "<nil>", "cluster_name": "opi-prod-2", "environment": "prod", "exporter": "OTLP", "level": "ERROR", "namespace": "default", "project": "liveramp-eng-dist", "region": "us", "resources_container_image_name": "gcr.io/liveramp-eng/s2s_packager", "resources_container_image_tag": "57de195-54", "resources_k8s_pod_name": "packager-daemon-7cc6576dd6-k9nq8", "service_name": "packager-daemon", "team": "opi"}, "values": [["1715117605639525509", "{\"body\":\"\\u003cnil\\u003e\",\"attributes\":{\"@timestamp\":\"2024-05-07T21:33:25.635Z\",\"@version\":1,\"class\":\"com.liveramp.s2s_packager.daemons.PackagerJoblet\",\"exception\":{\"exception_class\":\"java.lang.RuntimeException\",\"exception_message\":\"java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\",\"stacktrace\":\"java.lang.RuntimeException: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\\n\\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:151)\\n\\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:91)\\n\\tat com.liveramp.daemon_lib.executors.KubeJobletExecutor.execute(KubeJobletExecutor.java:74)\\n\\tat com.liveramp.daemon_lib.Daemon.processNext(Daemon.java:155)\\n\\tat com.liveramp.daemon_lib.Daemon.start(Daemon.java:108)\\n\\tat com.liveramp.s2s_packager.daemons.PackagerDaemon.main(PackagerDaemon.java:185)\\n\\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\n\\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\n\\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\n\\tat java.lang.reflect.Method.invoke(Method.java:498)\\n\\tat org.apache.hadoop.util.RunJar.run(RunJar.java:323)\\n\\tat org.apache.hadoop.util.RunJar.main(RunJar.java:236)\\nCaused by: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\\n\\tat com.liveramp.s2s_packager.ruby.YamlMetadataBuilder.write(YamlMetadataBuilder.java:47)\\n\\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:139)\\n\\t... 11 more\\nCaused by: java.lang.IllegalStateException: Cannot write empty metadata file.\\n\\tat com.liveramp.s2s_packager.ruby.YamlMetadataBuilder.write(YamlMetadataBuilder.java:44)\\n\\t... 12 more\"},\"file\":\"PackagerJoblet.java\",\"line_number\":\"101\",\"log.iostream\":\"stdout\",\"logger_name\":\"com.liveramp.s2s_packager.daemons.PackagerJoblet\",\"mdc\":{\"joblet_identifier\":\"4610756552300308151042\",\"request_id\":4740683361,\"source_host\":\"packager-daemon-7cc6576dd6-k9nq8\"},\"message\":\"Error while packaging\",\"method\":\"run\",\"source_host\":\"packager-daemon-7cc6576dd6-k9nq8\",\"thread_name\":\"main\"},\"resources\":{\"container.image.name\":\"gcr.io/liveramp-eng/s2s_packager\",\"container.image.tag\":\"57de195-54\",\"k8s.pod.name\":\"packager-daemon-7cc6576dd6-k9nq8\"}}"]]}, {"stream": {"app": "packager-daemon", "attributes__timestamp": "2024-05-01T22:26:01.741Z", "attributes__version": "1", "attributes_class": "com.liveramp.daemon_lib.executors.KubeJobletExecutor", "attributes_exception_exception_class": "com.liveramp.daemon_lib.utils.DaemonException", "attributes_exception_exception_message": "java.lang.RuntimeException: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.", "attributes_exception_stacktrace": "com.liveramp.daemon_lib.utils.DaemonException: java.lang.RuntimeException: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\n\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:107)\n\tat com.liveramp.daemon_lib.executors.KubeJobletExecutor.execute(KubeJobletExecutor.java:74)\n\tat com.liveramp.daemon_lib.Daemon.processNext(Daemon.java:155)\n\tat com.liveramp.daemon_lib.Daemon.start(Daemon.java:108)\n\tat com.liveramp.s2s_packager.daemons.PackagerDaemon.main(PackagerDaemon.java:185)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.hadoop.util.RunJar.run(RunJar.java:323)\n\tat org.apache.hadoop.util.RunJar.main(RunJar.java:236)\nCaused by: java.lang.RuntimeException: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\n\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:151)\n\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:91)\n\t... 10 more\nCaused by: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\n\tat com.liveramp.s2s_packager.ruby.YamlMetadataBuilder.write(YamlMetadataBuilder.java:47)\n\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:139)\n\t... 11 more\nCaused by: java.lang.IllegalStateException: Cannot write empty metadata file.\n\tat com.liveramp.s2s_packager.ruby.YamlMetadataBuilder.write(YamlMetadataBuilder.java:44)\n\t... 12 more", "attributes_file": "KubeJobletExecutor.java", "attributes_line_number": "77", "attributes_log_iostream": "stdout", "attributes_logger_name": "com.liveramp.daemon_lib.executors.KubeJobletExecutor", "attributes_mdc_joblet_identifier": "73934381311265635241966", "attributes_mdc_request_id": "4740683361", "attributes_mdc_source_host": "packager-daemon-7cc6576dd6-jtj85", "attributes_message": "Exception during joblet lifecycle for joblet 73934381311265635241966", "attributes_method": "execute", "attributes_source_host": "packager-daemon-7cc6576dd6-jtj85", "attributes_thread_name": "main", "body": "<nil>", "cluster_name": "opi-prod-2", "environment": "prod", "exporter": "OTLP", "level": "ERROR", "namespace": "default", "project": "liveramp-eng-dist", "region": "us", "resources_container_image_name": "gcr.io/liveramp-eng/s2s_packager", "resources_container_image_tag": "57de195-54", "resources_k8s_pod_name": "packager-daemon-7cc6576dd6-jtj85", "service_name": "packager-daemon", "team": "opi"}, "values": [["1714602361742788030", "{\"body\":\"\\u003cnil\\u003e\",\"attributes\":{\"@timestamp\":\"2024-05-01T22:26:01.741Z\",\"@version\":1,\"class\":\"com.liveramp.daemon_lib.executors.KubeJobletExecutor\",\"exception\":{\"exception_class\":\"com.liveramp.daemon_lib.utils.DaemonException\",\"exception_message\":\"java.lang.RuntimeException: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\",\"stacktrace\":\"com.liveramp.daemon_lib.utils.DaemonException: java.lang.RuntimeException: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\\n\\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:107)\\n\\tat com.liveramp.daemon_lib.executors.KubeJobletExecutor.execute(KubeJobletExecutor.java:74)\\n\\tat com.liveramp.daemon_lib.Daemon.processNext(Daemon.java:155)\\n\\tat com.liveramp.daemon_lib.Daemon.start(Daemon.java:108)\\n\\tat com.liveramp.s2s_packager.daemons.PackagerDaemon.main(PackagerDaemon.java:185)\\n\\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\n\\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\n\\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\n\\tat java.lang.reflect.Method.invoke(Method.java:498)\\n\\tat org.apache.hadoop.util.RunJar.run(RunJar.java:323)\\n\\tat org.apache.hadoop.util.RunJar.main(RunJar.java:236)\\nCaused by: java.lang.RuntimeException: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\\n\\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:151)\\n\\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:91)\\n\\t... 10 more\\nCaused by: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\\n\\tat com.liveramp.s2s_packager.ruby.YamlMetadataBuilder.write(YamlMetadataBuilder.java:47)\\n\\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:139)\\n\\t... 11 more\\nCaused by: java.lang.IllegalStateException: Cannot write empty metadata file.\\n\\tat com.liveramp.s2s_packager.ruby.YamlMetadataBuilder.write(YamlMetadataBuilder.java:44)\\n\\t... 12 more\"},\"file\":\"KubeJobletExecutor.java\",\"line_number\":\"77\",\"log.iostream\":\"stdout\",\"logger_name\":\"com.liveramp.daemon_lib.executors.KubeJobletExecutor\",\"mdc\":{\"joblet_identifier\":\"73934381311265635241966\",\"request_id\":4740683361,\"source_host\":\"packager-daemon-7cc6576dd6-jtj85\"},\"message\":\"Exception during joblet lifecycle for joblet 73934381311265635241966\",\"method\":\"execute\",\"source_host\":\"packager-daemon-7cc6576dd6-jtj85\",\"thread_name\":\"main\"},\"resources\":{\"container.image.name\":\"gcr.io/liveramp-eng/s2s_packager\",\"container.image.tag\":\"57de195-54\",\"k8s.pod.name\":\"packager-daemon-7cc6576dd6-jtj85\"}}"]]}, {"stream": {"app": "packager-daemon", "attributes__timestamp": "2024-05-01T22:26:01.441Z", "attributes__version": "1", "attributes_class": "com.liveramp.s2s_packager.daemons.PackagerJoblet", "attributes_exception_exception_class": "java.lang.RuntimeException", "attributes_exception_exception_message": "java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.", "attributes_exception_stacktrace": "java.lang.RuntimeException: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\n\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:151)\n\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:91)\n\tat com.liveramp.daemon_lib.executors.KubeJobletExecutor.execute(KubeJobletExecutor.java:74)\n\tat com.liveramp.daemon_lib.Daemon.processNext(Daemon.java:155)\n\tat com.liveramp.daemon_lib.Daemon.start(Daemon.java:108)\n\tat com.liveramp.s2s_packager.daemons.PackagerDaemon.main(PackagerDaemon.java:185)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.hadoop.util.RunJar.run(RunJar.java:323)\n\tat org.apache.hadoop.util.RunJar.main(RunJar.java:236)\nCaused by: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\n\tat com.liveramp.s2s_packager.ruby.YamlMetadataBuilder.write(YamlMetadataBuilder.java:47)\n\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:139)\n\t... 11 more\nCaused by: java.lang.IllegalStateException: Cannot write empty metadata file.\n\tat com.liveramp.s2s_packager.ruby.YamlMetadataBuilder.write(YamlMetadataBuilder.java:44)\n\t... 12 more", "attributes_file": "PackagerJoblet.java", "attributes_line_number": "101", "attributes_log_iostream": "stdout", "attributes_logger_name": "com.liveramp.s2s_packager.daemons.PackagerJoblet", "attributes_mdc_joblet_identifier": "73934381311265635241966", "attributes_mdc_request_id": "4740683361", "attributes_mdc_source_host": "packager-daemon-7cc6576dd6-jtj85", "attributes_message": "Error while packaging", "attributes_method": "run", "attributes_source_host": "packager-daemon-7cc6576dd6-jtj85", "attributes_thread_name": "main", "body": "<nil>", "cluster_name": "opi-prod-2", "environment": "prod", "exporter": "OTLP", "level": "ERROR", "namespace": "default", "project": "liveramp-eng-dist", "region": "us", "resources_container_image_name": "gcr.io/liveramp-eng/s2s_packager", "resources_container_image_tag": "57de195-54", "resources_k8s_pod_name": "packager-daemon-7cc6576dd6-jtj85", "service_name": "packager-daemon", "team": "opi"}, "values": [["1714602361452034876", "{\"body\":\"\\u003cnil\\u003e\",\"attributes\":{\"@timestamp\":\"2024-05-01T22:26:01.441Z\",\"@version\":1,\"class\":\"com.liveramp.s2s_packager.daemons.PackagerJoblet\",\"exception\":{\"exception_class\":\"java.lang.RuntimeException\",\"exception_message\":\"java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\",\"stacktrace\":\"java.lang.RuntimeException: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\\n\\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:151)\\n\\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:91)\\n\\tat com.liveramp.daemon_lib.executors.KubeJobletExecutor.execute(KubeJobletExecutor.java:74)\\n\\tat com.liveramp.daemon_lib.Daemon.processNext(Daemon.java:155)\\n\\tat com.liveramp.daemon_lib.Daemon.start(Daemon.java:108)\\n\\tat com.liveramp.s2s_packager.daemons.PackagerDaemon.main(PackagerDaemon.java:185)\\n\\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\n\\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\n\\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\n\\tat java.lang.reflect.Method.invoke(Method.java:498)\\n\\tat org.apache.hadoop.util.RunJar.run(RunJar.java:323)\\n\\tat org.apache.hadoop.util.RunJar.main(RunJar.java:236)\\nCaused by: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\\n\\tat com.liveramp.s2s_packager.ruby.YamlMetadataBuilder.write(YamlMetadataBuilder.java:47)\\n\\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:139)\\n\\t... 11 more\\nCaused by: java.lang.IllegalStateException: Cannot write empty metadata file.\\n\\tat com.liveramp.s2s_packager.ruby.YamlMetadataBuilder.write(YamlMetadataBuilder.java:44)\\n\\t... 12 more\"},\"file\":\"PackagerJoblet.java\",\"line_number\":\"101\",\"log.iostream\":\"stdout\",\"logger_name\":\"com.liveramp.s2s_packager.daemons.PackagerJoblet\",\"mdc\":{\"joblet_identifier\":\"73934381311265635241966\",\"request_id\":4740683361,\"source_host\":\"packager-daemon-7cc6576dd6-jtj85\"},\"message\":\"Error while packaging\",\"method\":\"run\",\"source_host\":\"packager-daemon-7cc6576dd6-jtj85\",\"thread_name\":\"main\"},\"resources\":{\"container.image.name\":\"gcr.io/liveramp-eng/s2s_packager\",\"container.image.tag\":\"57de195-54\",\"k8s.pod.name\":\"packager-daemon-7cc6576dd6-jtj85\"}}"]]}, {"stream": {"app": "packager-daemon", "attributes__timestamp": "2024-05-01T07:03:23.782Z", "attributes__version": "1", "attributes_class": "com.liveramp.daemon_lib.executors.KubeJobletExecutor", "attributes_exception_exception_class": "com.liveramp.daemon_lib.utils.DaemonException", "attributes_exception_exception_message": "java.lang.RuntimeException: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.", "attributes_exception_stacktrace": "com.liveramp.daemon_lib.utils.DaemonException: java.lang.RuntimeException: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\n\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:107)\n\tat com.liveramp.daemon_lib.executors.KubeJobletExecutor.execute(KubeJobletExecutor.java:74)\n\tat com.liveramp.daemon_lib.Daemon.processNext(Daemon.java:155)\n\tat com.liveramp.daemon_lib.Daemon.start(Daemon.java:108)\n\tat com.liveramp.s2s_packager.daemons.PackagerDaemon.main(PackagerDaemon.java:185)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.hadoop.util.RunJar.run(RunJar.java:323)\n\tat org.apache.hadoop.util.RunJar.main(RunJar.java:236)\nCaused by: java.lang.RuntimeException: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\n\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:151)\n\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:91)\n\t... 10 more\nCaused by: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\n\tat com.liveramp.s2s_packager.ruby.YamlMetadataBuilder.write(YamlMetadataBuilder.java:47)\n\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:139)\n\t... 11 more\nCaused by: java.lang.IllegalStateException: Cannot write empty metadata file.\n\tat com.liveramp.s2s_packager.ruby.YamlMetadataBuilder.write(YamlMetadataBuilder.java:44)\n\t... 12 more", "attributes_file": "KubeJobletExecutor.java", "attributes_line_number": "77", "attributes_log_iostream": "stdout", "attributes_logger_name": "com.liveramp.daemon_lib.executors.KubeJobletExecutor", "attributes_mdc_joblet_identifier": "827456096804832890622914", "attributes_mdc_request_id": "4740683361", "attributes_mdc_source_host": "packager-daemon-7cc6576dd6-8qn28", "attributes_message": "Exception during joblet lifecycle for joblet 827456096804832890622914", "attributes_method": "execute", "attributes_source_host": "packager-daemon-7cc6576dd6-8qn28", "attributes_thread_name": "main", "body": "<nil>", "cluster_name": "opi-prod-2", "environment": "prod", "exporter": "OTLP", "level": "ERROR", "namespace": "default", "project": "liveramp-eng-dist", "region": "us", "resources_container_image_name": "gcr.io/liveramp-eng/s2s_packager", "resources_container_image_tag": "57de195-54", "resources_k8s_pod_name": "packager-daemon-7cc6576dd6-8qn28", "service_name": "packager-daemon", "team": "opi"}, "values": [["1714547003783473549", "{\"body\":\"\\u003cnil\\u003e\",\"attributes\":{\"@timestamp\":\"2024-05-01T07:03:23.782Z\",\"@version\":1,\"class\":\"com.liveramp.daemon_lib.executors.KubeJobletExecutor\",\"exception\":{\"exception_class\":\"com.liveramp.daemon_lib.utils.DaemonException\",\"exception_message\":\"java.lang.RuntimeException: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\",\"stacktrace\":\"com.liveramp.daemon_lib.utils.DaemonException: java.lang.RuntimeException: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\\n\\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:107)\\n\\tat com.liveramp.daemon_lib.executors.KubeJobletExecutor.execute(KubeJobletExecutor.java:74)\\n\\tat com.liveramp.daemon_lib.Daemon.processNext(Daemon.java:155)\\n\\tat com.liveramp.daemon_lib.Daemon.start(Daemon.java:108)\\n\\tat com.liveramp.s2s_packager.daemons.PackagerDaemon.main(PackagerDaemon.java:185)\\n\\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\n\\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\n\\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\n\\tat java.lang.reflect.Method.invoke(Method.java:498)\\n\\tat org.apache.hadoop.util.RunJar.run(RunJar.java:323)\\n\\tat org.apache.hadoop.util.RunJar.main(RunJar.java:236)\\nCaused by: java.lang.RuntimeException: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\\n\\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:151)\\n\\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:91)\\n\\t... 10 more\\nCaused by: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\\n\\tat com.liveramp.s2s_packager.ruby.YamlMetadataBuilder.write(YamlMetadataBuilder.java:47)\\n\\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:139)\\n\\t... 11 more\\nCaused by: java.lang.IllegalStateException: Cannot write empty metadata file.\\n\\tat com.liveramp.s2s_packager.ruby.YamlMetadataBuilder.write(YamlMetadataBuilder.java:44)\\n\\t... 12 more\"},\"file\":\"KubeJobletExecutor.java\",\"line_number\":\"77\",\"log.iostream\":\"stdout\",\"logger_name\":\"com.liveramp.daemon_lib.executors.KubeJobletExecutor\",\"mdc\":{\"joblet_identifier\":\"827456096804832890622914\",\"request_id\":4740683361,\"source_host\":\"packager-daemon-7cc6576dd6-8qn28\"},\"message\":\"Exception during joblet lifecycle for joblet 827456096804832890622914\",\"method\":\"execute\",\"source_host\":\"packager-daemon-7cc6576dd6-8qn28\",\"thread_name\":\"main\"},\"resources\":{\"container.image.name\":\"gcr.io/liveramp-eng/s2s_packager\",\"container.image.tag\":\"57de195-54\",\"k8s.pod.name\":\"packager-daemon-7cc6576dd6-8qn28\"}}"]]}, {"stream": {"app": "packager-daemon", "attributes__timestamp": "2024-05-01T07:03:23.655Z", "attributes__version": "1", "attributes_class": "com.liveramp.s2s_packager.daemons.PackagerJoblet", "attributes_exception_exception_class": "java.lang.RuntimeException", "attributes_exception_exception_message": "java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.", "attributes_exception_stacktrace": "java.lang.RuntimeException: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\n\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:151)\n\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:91)\n\tat com.liveramp.daemon_lib.executors.KubeJobletExecutor.execute(KubeJobletExecutor.java:74)\n\tat com.liveramp.daemon_lib.Daemon.processNext(Daemon.java:155)\n\tat com.liveramp.daemon_lib.Daemon.start(Daemon.java:108)\n\tat com.liveramp.s2s_packager.daemons.PackagerDaemon.main(PackagerDaemon.java:185)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.hadoop.util.RunJar.run(RunJar.java:323)\n\tat org.apache.hadoop.util.RunJar.main(RunJar.java:236)\nCaused by: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\n\tat com.liveramp.s2s_packager.ruby.YamlMetadataBuilder.write(YamlMetadataBuilder.java:47)\n\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:139)\n\t... 11 more\nCaused by: java.lang.IllegalStateException: Cannot write empty metadata file.\n\tat com.liveramp.s2s_packager.ruby.YamlMetadataBuilder.write(YamlMetadataBuilder.java:44)\n\t... 12 more", "attributes_file": "PackagerJoblet.java", "attributes_line_number": "101", "attributes_log_iostream": "stdout", "attributes_logger_name": "com.liveramp.s2s_packager.daemons.PackagerJoblet", "attributes_mdc_joblet_identifier": "827456096804832890622914", "attributes_mdc_request_id": "4740683361", "attributes_mdc_source_host": "packager-daemon-7cc6576dd6-8qn28", "attributes_message": "Error while packaging", "attributes_method": "run", "attributes_source_host": "packager-daemon-7cc6576dd6-8qn28", "attributes_thread_name": "main", "body": "<nil>", "cluster_name": "opi-prod-2", "environment": "prod", "exporter": "OTLP", "level": "ERROR", "namespace": "default", "project": "liveramp-eng-dist", "region": "us", "resources_container_image_name": "gcr.io/liveramp-eng/s2s_packager", "resources_container_image_tag": "57de195-54", "resources_k8s_pod_name": "packager-daemon-7cc6576dd6-8qn28", "service_name": "packager-daemon", "team": "opi"}, "values": [["1714547003664752617", "{\"body\":\"\\u003cnil\\u003e\",\"attributes\":{\"@timestamp\":\"2024-05-01T07:03:23.655Z\",\"@version\":1,\"class\":\"com.liveramp.s2s_packager.daemons.PackagerJoblet\",\"exception\":{\"exception_class\":\"java.lang.RuntimeException\",\"exception_message\":\"java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\",\"stacktrace\":\"java.lang.RuntimeException: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\\n\\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:151)\\n\\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:91)\\n\\tat com.liveramp.daemon_lib.executors.KubeJobletExecutor.execute(KubeJobletExecutor.java:74)\\n\\tat com.liveramp.daemon_lib.Daemon.processNext(Daemon.java:155)\\n\\tat com.liveramp.daemon_lib.Daemon.start(Daemon.java:108)\\n\\tat com.liveramp.s2s_packager.daemons.PackagerDaemon.main(PackagerDaemon.java:185)\\n\\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\n\\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\n\\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\n\\tat java.lang.reflect.Method.invoke(Method.java:498)\\n\\tat org.apache.hadoop.util.RunJar.run(RunJar.java:323)\\n\\tat org.apache.hadoop.util.RunJar.main(RunJar.java:236)\\nCaused by: java.lang.RuntimeException: java.lang.IllegalStateException: Cannot write empty metadata file.\\n\\tat com.liveramp.s2s_packager.ruby.YamlMetadataBuilder.write(YamlMetadataBuilder.java:47)\\n\\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:139)\\n\\t... 11 more\\nCaused by: java.lang.IllegalStateException: Cannot write empty metadata file.\\n\\tat com.liveramp.s2s_packager.ruby.YamlMetadataBuilder.write(YamlMetadataBuilder.java:44)\\n\\t... 12 more\"},\"file\":\"PackagerJoblet.java\",\"line_number\":\"101\",\"log.iostream\":\"stdout\",\"logger_name\":\"com.liveramp.s2s_packager.daemons.PackagerJoblet\",\"mdc\":{\"joblet_identifier\":\"827456096804832890622914\",\"request_id\":4740683361,\"source_host\":\"packager-daemon-7cc6576dd6-8qn28\"},\"message\":\"Error while packaging\",\"method\":\"run\",\"source_host\":\"packager-daemon-7cc6576dd6-8qn28\",\"thread_name\":\"main\"},\"resources\":{\"container.image.name\":\"gcr.io/liveramp-eng/s2s_packager\",\"container.image.tag\":\"57de195-54\",\"k8s.pod.name\":\"packager-daemon-7cc6576dd6-8qn28\"}}"]]}, {"stream": {"app": "packager-daemon", "attributes__timestamp": "2024-04-17T08:35:43.339Z", "attributes__version": "1", "attributes_class": "com.liveramp.daemon_lib.executors.KubeJobletExecutor", "attributes_exception_exception_class": "com.liveramp.daemon_lib.utils.DaemonException", "attributes_exception_exception_message": "java.lang.OutOfMemoryError: Java heap space", "attributes_exception_stacktrace": "com.liveramp.daemon_lib.utils.DaemonException: java.lang.OutOfMemoryError: Java heap space\n\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:107)\n\tat com.liveramp.daemon_lib.executors.KubeJobletExecutor.execute(KubeJobletExecutor.java:74)\n\tat com.liveramp.daemon_lib.Daemon.processNext(Daemon.java:155)\n\tat com.liveramp.daemon_lib.Daemon.start(Daemon.java:108)\n\tat com.liveramp.s2s_packager.daemons.PackagerDaemon.main(PackagerDaemon.java:185)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.hadoop.util.RunJar.run(RunJar.java:323)\n\tat org.apache.hadoop.util.RunJar.main(RunJar.java:236)\nCaused by: java.lang.OutOfMemoryError: Java heap space\n\tat java.nio.HeapByteBuffer.<init>(HeapByteBuffer.java:57)\n\tat java.nio.ByteBuffer.allocate(ByteBuffer.java:335)\n\tat com.google.cloud.storage.Buffers.allocate(Buffers.java:118)\n\tat com.google.cloud.storage.BufferHandle$$Lambda$962/1553503962.apply(Unknown Source)\n\tat com.google.cloud.storage.BufferHandle$LazyBufferHandle.get(BufferHandle.java:93)\n\tat com.google.cloud.storage.BufferHandle$LazyBufferHandle.get(BufferHandle.java:51)\n\tat com.google.cloud.storage.DefaultBufferedWritableByteChannel.write(DefaultBufferedWritableByteChannel.java:87)\n\tat com.google.cloud.storage.StorageByteChannels$SynchronizedBufferedWritableByteChannel.write(StorageByteChannels.java:109)\n\tat com.google.cloud.storage.BaseStorageWriteChannel.write(BaseStorageWriteChannel.java:102)\n\tat java.nio.channels.Channels.writeFullyImpl(Channels.java:78)\n\tat java.nio.channels.Channels.writeFully(Channels.java:101)\n\tat java.nio.channels.Channels.access$000(Channels.java:61)\n\tat java.nio.channels.Channels$1.write(Channels.java:174)\n\tat java.io.OutputStream.write(OutputStream.java:75)\n\tat com.liveramp.s2s_distribution_lib.util.ParallelGZ$PGZOutputStream.writeHeader(ParallelGZ.java:393)\n\tat com.liveramp.s2s_distribution_lib.util.ParallelGZ$PGZOutputStream.<init>(ParallelGZ.java:359)\n\tat com.liveramp.s2s_distribution_lib.util.ParallelGZ$PGZOutputStream.<init>(ParallelGZ.java:375)\n\tat com.liveramp.s2s_packager.packager.WriterFactory.getWriter(WriterFactory.java:59)\n\tat com.liveramp.s2s_packager.packager.PartitionWriter.getOutputStream(PartitionWriter.java:77)\n\tat com.liveramp.s2s_packager.packager.PartitionWriter.write(PartitionWriter.java:55)\n\tat com.liveramp.s2s_packager.packager.PartitionWriter.write(PartitionWriter.java:49)\n\tat com.liveramp.s2s_packager.packager.BatchUtils.copySplitCompress(BatchUtils.java:129)\n\tat com.liveramp.s2s_packager.ruby.TemplatePackager.copySplitCompress(TemplatePackager.java:195)\n\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:114)\n\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:91)\n\tat com.liveramp.daemon_lib.executors.KubeJobletExecutor.execute(KubeJobletExecutor.java:74)\n\tat com.liveramp.daemon_lib.Daemon.processNext(Daemon.java:155)\n\tat com.liveramp.daemon_lib.Daemon.start(Daemon.java:108)\n\tat com.liveramp.s2s_packager.daemons.PackagerDaemon.main(PackagerDaemon.java:185)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)", "attributes_file": "KubeJobletExecutor.java", "attributes_line_number": "77", "attributes_log_iostream": "stdout", "attributes_logger_name": "com.liveramp.daemon_lib.executors.KubeJobletExecutor", "attributes_mdc_joblet_identifier": "14610641453649950143709139", "attributes_mdc_request_id": "4740683361", "attributes_mdc_source_host": "packager-daemon-7cc6576dd6-nnrml", "attributes_message": "Exception during joblet lifecycle for joblet 14610641453649950143709139", "attributes_method": "execute", "attributes_source_host": "packager-daemon-7cc6576dd6-nnrml", "attributes_thread_name": "main", "body": "<nil>", "cluster_name": "opi-prod-2", "environment": "prod", "exporter": "OTLP", "level": "ERROR", "namespace": "default", "project": "liveramp-eng-dist", "region": "us", "resources_container_image_name": "gcr.io/liveramp-eng/s2s_packager", "resources_container_image_tag": "57de195-54", "resources_k8s_pod_name": "packager-daemon-7cc6576dd6-nnrml", "service_name": "packager-daemon", "team": "opi"}, "values": [["1713342943340387492", "{\"body\":\"\\u003cnil\\u003e\",\"attributes\":{\"@timestamp\":\"2024-04-17T08:35:43.339Z\",\"@version\":1,\"class\":\"com.liveramp.daemon_lib.executors.KubeJobletExecutor\",\"exception\":{\"exception_class\":\"com.liveramp.daemon_lib.utils.DaemonException\",\"exception_message\":\"java.lang.OutOfMemoryError: Java heap space\",\"stacktrace\":\"com.liveramp.daemon_lib.utils.DaemonException: java.lang.OutOfMemoryError: Java heap space\\n\\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:107)\\n\\tat com.liveramp.daemon_lib.executors.KubeJobletExecutor.execute(KubeJobletExecutor.java:74)\\n\\tat com.liveramp.daemon_lib.Daemon.processNext(Daemon.java:155)\\n\\tat com.liveramp.daemon_lib.Daemon.start(Daemon.java:108)\\n\\tat com.liveramp.s2s_packager.daemons.PackagerDaemon.main(PackagerDaemon.java:185)\\n\\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\n\\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\n\\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\n\\tat java.lang.reflect.Method.invoke(Method.java:498)\\n\\tat org.apache.hadoop.util.RunJar.run(RunJar.java:323)\\n\\tat org.apache.hadoop.util.RunJar.main(RunJar.java:236)\\nCaused by: java.lang.OutOfMemoryError: Java heap space\\n\\tat java.nio.HeapByteBuffer.\\u003cinit\\u003e(HeapByteBuffer.java:57)\\n\\tat java.nio.ByteBuffer.allocate(ByteBuffer.java:335)\\n\\tat com.google.cloud.storage.Buffers.allocate(Buffers.java:118)\\n\\tat com.google.cloud.storage.BufferHandle$$Lambda$962/1553503962.apply(Unknown Source)\\n\\tat com.google.cloud.storage.BufferHandle$LazyBufferHandle.get(BufferHandle.java:93)\\n\\tat com.google.cloud.storage.BufferHandle$LazyBufferHandle.get(BufferHandle.java:51)\\n\\tat com.google.cloud.storage.DefaultBufferedWritableByteChannel.write(DefaultBufferedWritableByteChannel.java:87)\\n\\tat com.google.cloud.storage.StorageByteChannels$SynchronizedBufferedWritableByteChannel.write(StorageByteChannels.java:109)\\n\\tat com.google.cloud.storage.BaseStorageWriteChannel.write(BaseStorageWriteChannel.java:102)\\n\\tat java.nio.channels.Channels.writeFullyImpl(Channels.java:78)\\n\\tat java.nio.channels.Channels.writeFully(Channels.java:101)\\n\\tat java.nio.channels.Channels.access$000(Channels.java:61)\\n\\tat java.nio.channels.Channels$1.write(Channels.java:174)\\n\\tat java.io.OutputStream.write(OutputStream.java:75)\\n\\tat com.liveramp.s2s_distribution_lib.util.ParallelGZ$PGZOutputStream.writeHeader(ParallelGZ.java:393)\\n\\tat com.liveramp.s2s_distribution_lib.util.ParallelGZ$PGZOutputStream.\\u003cinit\\u003e(ParallelGZ.java:359)\\n\\tat com.liveramp.s2s_distribution_lib.util.ParallelGZ$PGZOutputStream.\\u003cinit\\u003e(ParallelGZ.java:375)\\n\\tat com.liveramp.s2s_packager.packager.WriterFactory.getWriter(WriterFactory.java:59)\\n\\tat com.liveramp.s2s_packager.packager.PartitionWriter.getOutputStream(PartitionWriter.java:77)\\n\\tat com.liveramp.s2s_packager.packager.PartitionWriter.write(PartitionWriter.java:55)\\n\\tat com.liveramp.s2s_packager.packager.PartitionWriter.write(PartitionWriter.java:49)\\n\\tat com.liveramp.s2s_packager.packager.BatchUtils.copySplitCompress(BatchUtils.java:129)\\n\\tat com.liveramp.s2s_packager.ruby.TemplatePackager.copySplitCompress(TemplatePackager.java:195)\\n\\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:114)\\n\\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:91)\\n\\tat com.liveramp.daemon_lib.executors.KubeJobletExecutor.execute(KubeJobletExecutor.java:74)\\n\\tat com.liveramp.daemon_lib.Daemon.processNext(Daemon.java:155)\\n\\tat com.liveramp.daemon_lib.Daemon.start(Daemon.java:108)\\n\\tat com.liveramp.s2s_packager.daemons.PackagerDaemon.main(PackagerDaemon.java:185)\\n\\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\n\\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\n\\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\"},\"file\":\"KubeJobletExecutor.java\",\"line_number\":\"77\",\"log.iostream\":\"stdout\",\"logger_name\":\"com.liveramp.daemon_lib.executors.KubeJobletExecutor\",\"mdc\":{\"joblet_identifier\":\"14610641453649950143709139\",\"request_id\":4740683361,\"source_host\":\"packager-daemon-7cc6576dd6-nnrml\"},\"message\":\"Exception during joblet lifecycle for joblet 14610641453649950143709139\",\"method\":\"execute\",\"source_host\":\"packager-daemon-7cc6576dd6-nnrml\",\"thread_name\":\"main\"},\"resources\":{\"container.image.name\":\"gcr.io/liveramp-eng/s2s_packager\",\"container.image.tag\":\"57de195-54\",\"k8s.pod.name\":\"packager-daemon-7cc6576dd6-nnrml\"}}"]]}, {"stream": {"app": "packager-daemon", "attributes__timestamp": "2024-04-17T08:35:43.223Z", "attributes__version": "1", "attributes_class": "com.liveramp.s2s_packager.daemons.PackagerJoblet", "attributes_exception_exception_class": "java.lang.OutOfMemoryError", "attributes_exception_exception_message": "Java heap space", "attributes_exception_stacktrace": "java.lang.OutOfMemoryError: Java heap space\n\tat java.nio.HeapByteBuffer.<init>(HeapByteBuffer.java:57)\n\tat java.nio.ByteBuffer.allocate(ByteBuffer.java:335)\n\tat com.google.cloud.storage.Buffers.allocate(Buffers.java:118)\n\tat com.google.cloud.storage.BufferHandle$$Lambda$962/1553503962.apply(Unknown Source)\n\tat com.google.cloud.storage.BufferHandle$LazyBufferHandle.get(BufferHandle.java:93)\n\tat com.google.cloud.storage.BufferHandle$LazyBufferHandle.get(BufferHandle.java:51)\n\tat com.google.cloud.storage.DefaultBufferedWritableByteChannel.write(DefaultBufferedWritableByteChannel.java:87)\n\tat com.google.cloud.storage.StorageByteChannels$SynchronizedBufferedWritableByteChannel.write(StorageByteChannels.java:109)\n\tat com.google.cloud.storage.BaseStorageWriteChannel.write(BaseStorageWriteChannel.java:102)\n\tat java.nio.channels.Channels.writeFullyImpl(Channels.java:78)\n\tat java.nio.channels.Channels.writeFully(Channels.java:101)\n\tat java.nio.channels.Channels.access$000(Channels.java:61)\n\tat java.nio.channels.Channels$1.write(Channels.java:174)\n\tat java.io.OutputStream.write(OutputStream.java:75)\n\tat com.liveramp.s2s_distribution_lib.util.ParallelGZ$PGZOutputStream.writeHeader(ParallelGZ.java:393)\n\tat com.liveramp.s2s_distribution_lib.util.ParallelGZ$PGZOutputStream.<init>(ParallelGZ.java:359)\n\tat com.liveramp.s2s_distribution_lib.util.ParallelGZ$PGZOutputStream.<init>(ParallelGZ.java:375)\n\tat com.liveramp.s2s_packager.packager.WriterFactory.getWriter(WriterFactory.java:59)\n\tat com.liveramp.s2s_packager.packager.PartitionWriter.getOutputStream(PartitionWriter.java:77)\n\tat com.liveramp.s2s_packager.packager.PartitionWriter.write(PartitionWriter.java:55)\n\tat com.liveramp.s2s_packager.packager.PartitionWriter.write(PartitionWriter.java:49)\n\tat com.liveramp.s2s_packager.packager.BatchUtils.copySplitCompress(BatchUtils.java:129)\n\tat com.liveramp.s2s_packager.ruby.TemplatePackager.copySplitCompress(TemplatePackager.java:195)\n\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:114)\n\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:91)\n\tat com.liveramp.daemon_lib.executors.KubeJobletExecutor.execute(KubeJobletExecutor.java:74)\n\tat com.liveramp.daemon_lib.Daemon.processNext(Daemon.java:155)\n\tat com.liveramp.daemon_lib.Daemon.start(Daemon.java:108)\n\tat com.liveramp.s2s_packager.daemons.PackagerDaemon.main(PackagerDaemon.java:185)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)", "attributes_file": "PackagerJoblet.java", "attributes_line_number": "101", "attributes_log_iostream": "stdout", "attributes_logger_name": "com.liveramp.s2s_packager.daemons.PackagerJoblet", "attributes_mdc_joblet_identifier": "14610641453649950143709139", "attributes_mdc_request_id": "4740683361", "attributes_mdc_source_host": "packager-daemon-7cc6576dd6-nnrml", "attributes_message": "Error while packaging", "attributes_method": "run", "attributes_source_host": "packager-daemon-7cc6576dd6-nnrml", "attributes_thread_name": "main", "body": "<nil>", "cluster_name": "opi-prod-2", "environment": "prod", "exporter": "OTLP", "level": "ERROR", "namespace": "default", "project": "liveramp-eng-dist", "region": "us", "resources_container_image_name": "gcr.io/liveramp-eng/s2s_packager", "resources_container_image_tag": "57de195-54", "resources_k8s_pod_name": "packager-daemon-7cc6576dd6-nnrml", "service_name": "packager-daemon", "team": "opi"}, "values": [["1713342943225064856", "{\"body\":\"\\u003cnil\\u003e\",\"attributes\":{\"@timestamp\":\"2024-04-17T08:35:43.223Z\",\"@version\":1,\"class\":\"com.liveramp.s2s_packager.daemons.PackagerJoblet\",\"exception\":{\"exception_class\":\"java.lang.OutOfMemoryError\",\"exception_message\":\"Java heap space\",\"stacktrace\":\"java.lang.OutOfMemoryError: Java heap space\\n\\tat java.nio.HeapByteBuffer.\\u003cinit\\u003e(HeapByteBuffer.java:57)\\n\\tat java.nio.ByteBuffer.allocate(ByteBuffer.java:335)\\n\\tat com.google.cloud.storage.Buffers.allocate(Buffers.java:118)\\n\\tat com.google.cloud.storage.BufferHandle$$Lambda$962/1553503962.apply(Unknown Source)\\n\\tat com.google.cloud.storage.BufferHandle$LazyBufferHandle.get(BufferHandle.java:93)\\n\\tat com.google.cloud.storage.BufferHandle$LazyBufferHandle.get(BufferHandle.java:51)\\n\\tat com.google.cloud.storage.DefaultBufferedWritableByteChannel.write(DefaultBufferedWritableByteChannel.java:87)\\n\\tat com.google.cloud.storage.StorageByteChannels$SynchronizedBufferedWritableByteChannel.write(StorageByteChannels.java:109)\\n\\tat com.google.cloud.storage.BaseStorageWriteChannel.write(BaseStorageWriteChannel.java:102)\\n\\tat java.nio.channels.Channels.writeFullyImpl(Channels.java:78)\\n\\tat java.nio.channels.Channels.writeFully(Channels.java:101)\\n\\tat java.nio.channels.Channels.access$000(Channels.java:61)\\n\\tat java.nio.channels.Channels$1.write(Channels.java:174)\\n\\tat java.io.OutputStream.write(OutputStream.java:75)\\n\\tat com.liveramp.s2s_distribution_lib.util.ParallelGZ$PGZOutputStream.writeHeader(ParallelGZ.java:393)\\n\\tat com.liveramp.s2s_distribution_lib.util.ParallelGZ$PGZOutputStream.\\u003cinit\\u003e(ParallelGZ.java:359)\\n\\tat com.liveramp.s2s_distribution_lib.util.ParallelGZ$PGZOutputStream.\\u003cinit\\u003e(ParallelGZ.java:375)\\n\\tat com.liveramp.s2s_packager.packager.WriterFactory.getWriter(WriterFactory.java:59)\\n\\tat com.liveramp.s2s_packager.packager.PartitionWriter.getOutputStream(PartitionWriter.java:77)\\n\\tat com.liveramp.s2s_packager.packager.PartitionWriter.write(PartitionWriter.java:55)\\n\\tat com.liveramp.s2s_packager.packager.PartitionWriter.write(PartitionWriter.java:49)\\n\\tat com.liveramp.s2s_packager.packager.BatchUtils.copySplitCompress(BatchUtils.java:129)\\n\\tat com.liveramp.s2s_packager.ruby.TemplatePackager.copySplitCompress(TemplatePackager.java:195)\\n\\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:114)\\n\\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:91)\\n\\tat com.liveramp.daemon_lib.executors.KubeJobletExecutor.execute(KubeJobletExecutor.java:74)\\n\\tat com.liveramp.daemon_lib.Daemon.processNext(Daemon.java:155)\\n\\tat com.liveramp.daemon_lib.Daemon.start(Daemon.java:108)\\n\\tat com.liveramp.s2s_packager.daemons.PackagerDaemon.main(PackagerDaemon.java:185)\\n\\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\n\\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\n\\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\"},\"file\":\"PackagerJoblet.java\",\"line_number\":\"101\",\"log.iostream\":\"stdout\",\"logger_name\":\"com.liveramp.s2s_packager.daemons.PackagerJoblet\",\"mdc\":{\"joblet_identifier\":\"14610641453649950143709139\",\"request_id\":4740683361,\"source_host\":\"packager-daemon-7cc6576dd6-nnrml\"},\"message\":\"Error while packaging\",\"method\":\"run\",\"source_host\":\"packager-daemon-7cc6576dd6-nnrml\",\"thread_name\":\"main\"},\"resources\":{\"container.image.name\":\"gcr.io/liveramp-eng/s2s_packager\",\"container.image.tag\":\"57de195-54\",\"k8s.pod.name\":\"packager-daemon-7cc6576dd6-nnrml\"}}"]]}, {"stream": {"app": "packager-daemon", "attributes__timestamp": "2024-04-15T13:04:37.775Z", "attributes__version": "1", "attributes_class": "com.liveramp.daemon_lib.executors.KubeJobletExecutor", "attributes_exception_exception_class": "com.liveramp.daemon_lib.utils.DaemonException", "attributes_exception_exception_message": "java.lang.OutOfMemoryError: Java heap space", "attributes_exception_stacktrace": "com.liveramp.daemon_lib.utils.DaemonException: java.lang.OutOfMemoryError: Java heap space\n\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:107)\n\tat com.liveramp.daemon_lib.executors.KubeJobletExecutor.execute(KubeJobletExecutor.java:74)\n\tat com.liveramp.daemon_lib.Daemon.processNext(Daemon.java:155)\n\tat com.liveramp.daemon_lib.Daemon.start(Daemon.java:108)\n\tat com.liveramp.s2s_packager.daemons.PackagerDaemon.main(PackagerDaemon.java:185)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.hadoop.util.RunJar.run(RunJar.java:323)\n\tat org.apache.hadoop.util.RunJar.main(RunJar.java:236)\nCaused by: java.lang.OutOfMemoryError: Java heap space\n\tat java.nio.HeapByteBuffer.<init>(HeapByteBuffer.java:57)\n\tat java.nio.ByteBuffer.allocate(ByteBuffer.java:335)\n\tat com.google.cloud.storage.Buffers.allocate(Buffers.java:118)\n\tat com.google.cloud.storage.BufferHandle$$Lambda$945/1293384572.apply(Unknown Source)\n\tat com.google.cloud.storage.BufferHandle$LazyBufferHandle.get(BufferHandle.java:93)\n\tat com.google.cloud.storage.BufferHandle$LazyBufferHandle.get(BufferHandle.java:51)\n\tat com.google.cloud.storage.DefaultBufferedWritableByteChannel.write(DefaultBufferedWritableByteChannel.java:87)\n\tat com.google.cloud.storage.StorageByteChannels$SynchronizedBufferedWritableByteChannel.write(StorageByteChannels.java:109)\n\tat com.google.cloud.storage.BaseStorageWriteChannel.write(BaseStorageWriteChannel.java:102)\n\tat java.nio.channels.Channels.writeFullyImpl(Channels.java:78)\n\tat java.nio.channels.Channels.writeFully(Channels.java:101)\n\tat java.nio.channels.Channels.access$000(Channels.java:61)\n\tat java.nio.channels.Channels$1.write(Channels.java:174)\n\tat java.io.OutputStream.write(OutputStream.java:75)\n\tat com.liveramp.s2s_distribution_lib.util.ParallelGZ$PGZOutputStream.writeHeader(ParallelGZ.java:393)\n\tat com.liveramp.s2s_distribution_lib.util.ParallelGZ$PGZOutputStream.<init>(ParallelGZ.java:359)\n\tat com.liveramp.s2s_distribution_lib.util.ParallelGZ$PGZOutputStream.<init>(ParallelGZ.java:375)\n\tat com.liveramp.s2s_packager.packager.WriterFactory.getWriter(WriterFactory.java:59)\n\tat com.liveramp.s2s_packager.packager.PartitionWriter.getOutputStream(PartitionWriter.java:77)\n\tat com.liveramp.s2s_packager.packager.PartitionWriter.write(PartitionWriter.java:55)\n\tat com.liveramp.s2s_packager.packager.PartitionWriter.write(PartitionWriter.java:49)\n\tat com.liveramp.s2s_packager.packager.BatchUtils.copySplitCompress(BatchUtils.java:129)\n\tat com.liveramp.s2s_packager.ruby.TemplatePackager.copySplitCompress(TemplatePackager.java:195)\n\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:114)\n\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:91)\n\tat com.liveramp.daemon_lib.executors.KubeJobletExecutor.execute(KubeJobletExecutor.java:74)\n\tat com.liveramp.daemon_lib.Daemon.processNext(Daemon.java:155)\n\tat com.liveramp.daemon_lib.Daemon.start(Daemon.java:108)\n\tat com.liveramp.s2s_packager.daemons.PackagerDaemon.main(PackagerDaemon.java:185)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)", "attributes_file": "KubeJobletExecutor.java", "attributes_line_number": "77", "attributes_log_iostream": "stdout", "attributes_logger_name": "com.liveramp.daemon_lib.executors.KubeJobletExecutor", "attributes_mdc_joblet_identifier": "16062512683322755317491804", "attributes_mdc_request_id": "4740683361", "attributes_mdc_source_host": "packager-daemon-7cc6576dd6-jj56h", "attributes_message": "Exception during joblet lifecycle for joblet 16062512683322755317491804", "attributes_method": "execute", "attributes_source_host": "packager-daemon-7cc6576dd6-jj56h", "attributes_thread_name": "main", "body": "<nil>", "cluster_name": "opi-prod-2", "environment": "prod", "exporter": "OTLP", "level": "ERROR", "namespace": "default", "project": "liveramp-eng-dist", "region": "us", "resources_container_image_name": "gcr.io/liveramp-eng/s2s_packager", "resources_container_image_tag": "57de195-54", "resources_k8s_pod_name": "packager-daemon-7cc6576dd6-jj56h", "service_name": "packager-daemon", "team": "opi"}, "values": [["1713186277776498975", "{\"body\":\"\\u003cnil\\u003e\",\"attributes\":{\"@timestamp\":\"2024-04-15T13:04:37.775Z\",\"@version\":1,\"class\":\"com.liveramp.daemon_lib.executors.KubeJobletExecutor\",\"exception\":{\"exception_class\":\"com.liveramp.daemon_lib.utils.DaemonException\",\"exception_message\":\"java.lang.OutOfMemoryError: Java heap space\",\"stacktrace\":\"com.liveramp.daemon_lib.utils.DaemonException: java.lang.OutOfMemoryError: Java heap space\\n\\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:107)\\n\\tat com.liveramp.daemon_lib.executors.KubeJobletExecutor.execute(KubeJobletExecutor.java:74)\\n\\tat com.liveramp.daemon_lib.Daemon.processNext(Daemon.java:155)\\n\\tat com.liveramp.daemon_lib.Daemon.start(Daemon.java:108)\\n\\tat com.liveramp.s2s_packager.daemons.PackagerDaemon.main(PackagerDaemon.java:185)\\n\\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\n\\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\n\\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\n\\tat java.lang.reflect.Method.invoke(Method.java:498)\\n\\tat org.apache.hadoop.util.RunJar.run(RunJar.java:323)\\n\\tat org.apache.hadoop.util.RunJar.main(RunJar.java:236)\\nCaused by: java.lang.OutOfMemoryError: Java heap space\\n\\tat java.nio.HeapByteBuffer.\\u003cinit\\u003e(HeapByteBuffer.java:57)\\n\\tat java.nio.ByteBuffer.allocate(ByteBuffer.java:335)\\n\\tat com.google.cloud.storage.Buffers.allocate(Buffers.java:118)\\n\\tat com.google.cloud.storage.BufferHandle$$Lambda$945/1293384572.apply(Unknown Source)\\n\\tat com.google.cloud.storage.BufferHandle$LazyBufferHandle.get(BufferHandle.java:93)\\n\\tat com.google.cloud.storage.BufferHandle$LazyBufferHandle.get(BufferHandle.java:51)\\n\\tat com.google.cloud.storage.DefaultBufferedWritableByteChannel.write(DefaultBufferedWritableByteChannel.java:87)\\n\\tat com.google.cloud.storage.StorageByteChannels$SynchronizedBufferedWritableByteChannel.write(StorageByteChannels.java:109)\\n\\tat com.google.cloud.storage.BaseStorageWriteChannel.write(BaseStorageWriteChannel.java:102)\\n\\tat java.nio.channels.Channels.writeFullyImpl(Channels.java:78)\\n\\tat java.nio.channels.Channels.writeFully(Channels.java:101)\\n\\tat java.nio.channels.Channels.access$000(Channels.java:61)\\n\\tat java.nio.channels.Channels$1.write(Channels.java:174)\\n\\tat java.io.OutputStream.write(OutputStream.java:75)\\n\\tat com.liveramp.s2s_distribution_lib.util.ParallelGZ$PGZOutputStream.writeHeader(ParallelGZ.java:393)\\n\\tat com.liveramp.s2s_distribution_lib.util.ParallelGZ$PGZOutputStream.\\u003cinit\\u003e(ParallelGZ.java:359)\\n\\tat com.liveramp.s2s_distribution_lib.util.ParallelGZ$PGZOutputStream.\\u003cinit\\u003e(ParallelGZ.java:375)\\n\\tat com.liveramp.s2s_packager.packager.WriterFactory.getWriter(WriterFactory.java:59)\\n\\tat com.liveramp.s2s_packager.packager.PartitionWriter.getOutputStream(PartitionWriter.java:77)\\n\\tat com.liveramp.s2s_packager.packager.PartitionWriter.write(PartitionWriter.java:55)\\n\\tat com.liveramp.s2s_packager.packager.PartitionWriter.write(PartitionWriter.java:49)\\n\\tat com.liveramp.s2s_packager.packager.BatchUtils.copySplitCompress(BatchUtils.java:129)\\n\\tat com.liveramp.s2s_packager.ruby.TemplatePackager.copySplitCompress(TemplatePackager.java:195)\\n\\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:114)\\n\\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:91)\\n\\tat com.liveramp.daemon_lib.executors.KubeJobletExecutor.execute(KubeJobletExecutor.java:74)\\n\\tat com.liveramp.daemon_lib.Daemon.processNext(Daemon.java:155)\\n\\tat com.liveramp.daemon_lib.Daemon.start(Daemon.java:108)\\n\\tat com.liveramp.s2s_packager.daemons.PackagerDaemon.main(PackagerDaemon.java:185)\\n\\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\n\\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\n\\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\"},\"file\":\"KubeJobletExecutor.java\",\"line_number\":\"77\",\"log.iostream\":\"stdout\",\"logger_name\":\"com.liveramp.daemon_lib.executors.KubeJobletExecutor\",\"mdc\":{\"joblet_identifier\":\"16062512683322755317491804\",\"request_id\":4740683361,\"source_host\":\"packager-daemon-7cc6576dd6-jj56h\"},\"message\":\"Exception during joblet lifecycle for joblet 16062512683322755317491804\",\"method\":\"execute\",\"source_host\":\"packager-daemon-7cc6576dd6-jj56h\",\"thread_name\":\"main\"},\"resources\":{\"container.image.name\":\"gcr.io/liveramp-eng/s2s_packager\",\"container.image.tag\":\"57de195-54\",\"k8s.pod.name\":\"packager-daemon-7cc6576dd6-jj56h\"}}"]]}, {"stream": {"app": "packager-daemon", "attributes__timestamp": "2024-04-15T13:04:37.678Z", "attributes__version": "1", "attributes_class": "com.liveramp.s2s_packager.daemons.PackagerJoblet", "attributes_exception_exception_class": "java.lang.OutOfMemoryError", "attributes_exception_exception_message": "Java heap space", "attributes_exception_stacktrace": "java.lang.OutOfMemoryError: Java heap space\n\tat java.nio.HeapByteBuffer.<init>(HeapByteBuffer.java:57)\n\tat java.nio.ByteBuffer.allocate(ByteBuffer.java:335)\n\tat com.google.cloud.storage.Buffers.allocate(Buffers.java:118)\n\tat com.google.cloud.storage.BufferHandle$$Lambda$945/1293384572.apply(Unknown Source)\n\tat com.google.cloud.storage.BufferHandle$LazyBufferHandle.get(BufferHandle.java:93)\n\tat com.google.cloud.storage.BufferHandle$LazyBufferHandle.get(BufferHandle.java:51)\n\tat com.google.cloud.storage.DefaultBufferedWritableByteChannel.write(DefaultBufferedWritableByteChannel.java:87)\n\tat com.google.cloud.storage.StorageByteChannels$SynchronizedBufferedWritableByteChannel.write(StorageByteChannels.java:109)\n\tat com.google.cloud.storage.BaseStorageWriteChannel.write(BaseStorageWriteChannel.java:102)\n\tat java.nio.channels.Channels.writeFullyImpl(Channels.java:78)\n\tat java.nio.channels.Channels.writeFully(Channels.java:101)\n\tat java.nio.channels.Channels.access$000(Channels.java:61)\n\tat java.nio.channels.Channels$1.write(Channels.java:174)\n\tat java.io.OutputStream.write(OutputStream.java:75)\n\tat com.liveramp.s2s_distribution_lib.util.ParallelGZ$PGZOutputStream.writeHeader(ParallelGZ.java:393)\n\tat com.liveramp.s2s_distribution_lib.util.ParallelGZ$PGZOutputStream.<init>(ParallelGZ.java:359)\n\tat com.liveramp.s2s_distribution_lib.util.ParallelGZ$PGZOutputStream.<init>(ParallelGZ.java:375)\n\tat com.liveramp.s2s_packager.packager.WriterFactory.getWriter(WriterFactory.java:59)\n\tat com.liveramp.s2s_packager.packager.PartitionWriter.getOutputStream(PartitionWriter.java:77)\n\tat com.liveramp.s2s_packager.packager.PartitionWriter.write(PartitionWriter.java:55)\n\tat com.liveramp.s2s_packager.packager.PartitionWriter.write(PartitionWriter.java:49)\n\tat com.liveramp.s2s_packager.packager.BatchUtils.copySplitCompress(BatchUtils.java:129)\n\tat com.liveramp.s2s_packager.ruby.TemplatePackager.copySplitCompress(TemplatePackager.java:195)\n\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:114)\n\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:91)\n\tat com.liveramp.daemon_lib.executors.KubeJobletExecutor.execute(KubeJobletExecutor.java:74)\n\tat com.liveramp.daemon_lib.Daemon.processNext(Daemon.java:155)\n\tat com.liveramp.daemon_lib.Daemon.start(Daemon.java:108)\n\tat com.liveramp.s2s_packager.daemons.PackagerDaemon.main(PackagerDaemon.java:185)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)", "attributes_file": "PackagerJoblet.java", "attributes_line_number": "101", "attributes_log_iostream": "stdout", "attributes_logger_name": "com.liveramp.s2s_packager.daemons.PackagerJoblet", "attributes_mdc_joblet_identifier": "16062512683322755317491804", "attributes_mdc_request_id": "4740683361", "attributes_mdc_source_host": "packager-daemon-7cc6576dd6-jj56h", "attributes_message": "Error while packaging", "attributes_method": "run", "attributes_source_host": "packager-daemon-7cc6576dd6-jj56h", "attributes_thread_name": "main", "body": "<nil>", "cluster_name": "opi-prod-2", "environment": "prod", "exporter": "OTLP", "level": "ERROR", "namespace": "default", "project": "liveramp-eng-dist", "region": "us", "resources_container_image_name": "gcr.io/liveramp-eng/s2s_packager", "resources_container_image_tag": "57de195-54", "resources_k8s_pod_name": "packager-daemon-7cc6576dd6-jj56h", "service_name": "packager-daemon", "team": "opi"}, "values": [["1713186277679246541", "{\"body\":\"\\u003cnil\\u003e\",\"attributes\":{\"@timestamp\":\"2024-04-15T13:04:37.678Z\",\"@version\":1,\"class\":\"com.liveramp.s2s_packager.daemons.PackagerJoblet\",\"exception\":{\"exception_class\":\"java.lang.OutOfMemoryError\",\"exception_message\":\"Java heap space\",\"stacktrace\":\"java.lang.OutOfMemoryError: Java heap space\\n\\tat java.nio.HeapByteBuffer.\\u003cinit\\u003e(HeapByteBuffer.java:57)\\n\\tat java.nio.ByteBuffer.allocate(ByteBuffer.java:335)\\n\\tat com.google.cloud.storage.Buffers.allocate(Buffers.java:118)\\n\\tat com.google.cloud.storage.BufferHandle$$Lambda$945/1293384572.apply(Unknown Source)\\n\\tat com.google.cloud.storage.BufferHandle$LazyBufferHandle.get(BufferHandle.java:93)\\n\\tat com.google.cloud.storage.BufferHandle$LazyBufferHandle.get(BufferHandle.java:51)\\n\\tat com.google.cloud.storage.DefaultBufferedWritableByteChannel.write(DefaultBufferedWritableByteChannel.java:87)\\n\\tat com.google.cloud.storage.StorageByteChannels$SynchronizedBufferedWritableByteChannel.write(StorageByteChannels.java:109)\\n\\tat com.google.cloud.storage.BaseStorageWriteChannel.write(BaseStorageWriteChannel.java:102)\\n\\tat java.nio.channels.Channels.writeFullyImpl(Channels.java:78)\\n\\tat java.nio.channels.Channels.writeFully(Channels.java:101)\\n\\tat java.nio.channels.Channels.access$000(Channels.java:61)\\n\\tat java.nio.channels.Channels$1.write(Channels.java:174)\\n\\tat java.io.OutputStream.write(OutputStream.java:75)\\n\\tat com.liveramp.s2s_distribution_lib.util.ParallelGZ$PGZOutputStream.writeHeader(ParallelGZ.java:393)\\n\\tat com.liveramp.s2s_distribution_lib.util.ParallelGZ$PGZOutputStream.\\u003cinit\\u003e(ParallelGZ.java:359)\\n\\tat com.liveramp.s2s_distribution_lib.util.ParallelGZ$PGZOutputStream.\\u003cinit\\u003e(ParallelGZ.java:375)\\n\\tat com.liveramp.s2s_packager.packager.WriterFactory.getWriter(WriterFactory.java:59)\\n\\tat com.liveramp.s2s_packager.packager.PartitionWriter.getOutputStream(PartitionWriter.java:77)\\n\\tat com.liveramp.s2s_packager.packager.PartitionWriter.write(PartitionWriter.java:55)\\n\\tat com.liveramp.s2s_packager.packager.PartitionWriter.write(PartitionWriter.java:49)\\n\\tat com.liveramp.s2s_packager.packager.BatchUtils.copySplitCompress(BatchUtils.java:129)\\n\\tat com.liveramp.s2s_packager.ruby.TemplatePackager.copySplitCompress(TemplatePackager.java:195)\\n\\tat com.liveramp.s2s_packager.ruby.TemplatePackager.process(TemplatePackager.java:114)\\n\\tat com.liveramp.s2s_packager.daemons.PackagerJoblet.run(PackagerJoblet.java:91)\\n\\tat com.liveramp.daemon_lib.executors.KubeJobletExecutor.execute(KubeJobletExecutor.java:74)\\n\\tat com.liveramp.daemon_lib.Daemon.processNext(Daemon.java:155)\\n\\tat com.liveramp.daemon_lib.Daemon.start(Daemon.java:108)\\n\\tat com.liveramp.s2s_packager.daemons.PackagerDaemon.main(PackagerDaemon.java:185)\\n\\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\n\\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\n\\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\"},\"file\":\"PackagerJoblet.java\",\"line_number\":\"101\",\"log.iostream\":\"stdout\",\"logger_name\":\"com.liveramp.s2s_packager.daemons.PackagerJoblet\",\"mdc\":{\"joblet_identifier\":\"16062512683322755317491804\",\"request_id\":4740683361,\"source_host\":\"packager-daemon-7cc6576dd6-jj56h\"},\"message\":\"Error while packaging\",\"method\":\"run\",\"source_host\":\"packager-daemon-7cc6576dd6-jj56h\",\"thread_name\":\"main\"},\"resources\":{\"container.image.name\":\"gcr.io/liveramp-eng/s2s_packager\",\"container.image.tag\":\"57de195-54\",\"k8s.pod.name\":\"packager-daemon-7cc6576dd6-jj56h\"}}"]]}], "stats": {"summary": {"bytesProcessedPerSecond": 54552136, "linesProcessedPerSecond": 16965, "totalBytesProcessed": 5292581, "totalLinesProcessed": 1646, "execTime": 0.097019, "queueTime": 0.036686, "subqueries": 0, "totalEntriesReturned": 10, "splits": 2768, "shards": 5, "totalPostFilterLines": 20, "totalStructuredMetadataBytesProcessed": 16460}, "querier": {"store": {"totalChunksRef": 14, "totalChunksDownloaded": 14, "chunksDownloadTime": 6638757, "queryReferencedStructuredMetadata": false, "chunk": {"headChunkBytes": 0, "headChunkLines": 0, "decompressedBytes": 5292581, "decompressedLines": 1646, "compressedBytes": 576074, "totalDuplicates": 10, "postFilterLines": 20, "headChunkStructuredMetadataBytes": 0, "decompressedStructuredMetadataBytes": 16460}, "chunkRefsFetchTime": 5773241, "congestionControlLatency": 0, "pipelineWrapperFilteredLines": 0}}, "ingester": {"totalReached": 0, "totalChunksMatched": 0, "totalBatches": 0, "totalLinesSent": 0, "store": {"totalChunksRef": 0, "totalChunksDownloaded": 0, "chunksDownloadTime": 0, "queryReferencedStructuredMetadata": false, "chunk": {"headChunkBytes": 0, "headChunkLines": 0, "decompressedBytes": 0, "decompressedLines": 0, "compressedBytes": 0, "totalDuplicates": 0, "postFilterLines": 0, "headChunkStructuredMetadataBytes": 0, "decompressedStructuredMetadataBytes": 0}, "chunkRefsFetchTime": 0, "congestionControlLatency": 0, "pipelineWrapperFilteredLines": 0}}, "cache": {"chunk": {"entriesFound": 14, "entriesRequested": 14, "entriesStored": 0, "bytesReceived": 708924, "bytesSent": 0, "requests": 21, "downloadTime": 5533105, "queryLengthServed": 0}, "index": {"entriesFound": 0, "entriesRequested": 0, "entriesStored": 0, "bytesReceived": 0, "bytesSent": 0, "requests": 0, "downloadTime": 0, "queryLengthServed": 0}, "result": {"entriesFound": 2763, "entriesRequested": 2768, "entriesStored": 0, "bytesReceived": 1177038, "bytesSent": 0, "requests": 2768, "downloadTime": 102045661598, "queryLengthServed": 0}, "statsResult": {"entriesFound": 0, "entriesRequested": 0, "entriesStored": 0, "bytesReceived": 0, "bytesSent": 0, "requests": 0, "downloadTime": 0, "queryLengthServed": 0}, "volumeResult": {"entriesFound": 0, "entriesRequested": 0, "entriesStored": 0, "bytesReceived": 0, "bytesSent": 0, "requests": 0, "downloadTime": 0, "queryLengthServed": 0}, "seriesResult": {"entriesFound": 0, "entriesRequested": 0, "entriesStored": 0, "bytesReceived": 0, "bytesSent": 0, "requests": 0, "downloadTime": 0, "queryLengthServed": 0}, "labelResult": {"entriesFound": 0, "entriesRequested": 0, "entriesStored": 0, "bytesReceived": 0, "bytesSent": 0, "requests": 0, "downloadTime": 0, "queryLengthServed": 0}, "instantMetricResult": {"entriesFound": 0, "entriesRequested": 0, "entriesStored": 0, "bytesReceived": 0, "bytesSent": 0, "requests": 0, "downloadTime": 0, "queryLengthServed": 0}}, "index": {"totalChunks": 0, "postFilterChunks": 0, "shardsDuration": 0}}}}